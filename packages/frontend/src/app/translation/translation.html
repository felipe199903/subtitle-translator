<div class="translation-container">
  <div class="header">
    <button (click)="goBack()" class="back-btn">
      ‚Üê Voltar
    </button>
    <h1>Tradu√ß√£o de Legendas</h1>
    
    <!-- Indicador de treinamento ativo -->
    <div *ngIf="isTrainingActive" class="training-indicator">
      <div class="training-icon">üß†</div>
      <div class="training-info">
        <span class="training-text">Treinamento ativo</span>
        <span class="training-subtext">Melhorando dicion√°rio...</span>
      </div>
    </div>
  </div>

  <div class="file-info">
    <h3>Arquivo: {{ fileName }}</h3>
    <p>Idioma detectado: {{ getLanguageName(originalLanguage) }}</p>
    <p>Total de legendas: {{ subtitles.length }}</p>
  </div>

  <div class="actions">
    <button *ngIf="!translatedSrtContent && !isTranslating" 
            (click)="translateSubtitles()"
            class="translate-btn">
      Traduzir para Portugu√™s (BR)
    </button>

    <div *ngIf="isTranslating" class="loading">
      <div class="spinner"></div>
      <div class="loading-content">
        <p>Traduzindo legendas...</p>
        <div *ngIf="isTrainingActive" class="training-boost">
          <span class="boost-icon">‚ö°</span>
          <span class="boost-text">Usando melhorias do treinamento</span>
        </div>
        <div *ngIf="translationProgress" class="translation-progress">
          <div class="progress-bar">
            <div class="progress-fill" [style.width.%]="translationProgress.percentage"></div>
          </div>
          <span class="progress-text">
            {{ translationProgress.current }}/{{ translationProgress.total }} 
            ({{ translationProgress.percentage }}%)
          </span>
        </div>
      </div>
    </div>

    <div *ngIf="translatedSrtContent" class="download-section">
      <button (click)="downloadTranslatedSRT()"
              class="download-btn">
        üì• Baixar SRT Traduzido
      </button>
      <p class="download-info">
        Arquivo pronto para download com {{ subtitles.length }} legendas traduzidas
      </p>
    </div>
  </div>

  <div *ngIf="translationError" class="error-message">
    {{ translationError }}
  </div>

  <div *ngIf="translationSuccess" class="success-message">
    {{ translationSuccess }}
  </div>

  <div class="subtitles-preview">
    <h3>Pr√©via das Legendas</h3>
    <div *ngIf="translatedSrtContent" class="sync-info">
      <span class="sync-icon">üîÑ</span>
      <span>Scrolls sincronizados | Passe o mouse sobre as legendas para destacar</span>
      <span *ngIf="hoveredIndex !== null" class="highlight-indicator">
        ‚ú® Destacando legenda {{ hoveredIndex + 1 }}
      </span>
    </div>
    <div class="subtitles-grid">
      <div class="subtitle-column">
        <h4>Original</h4>
        <div class="subtitle-list" 
             #originalList
             (scroll)="onScroll($event, 'original')">
          <div *ngFor="let subtitle of subtitles; let i = index" 
               class="subtitle-item"
               [class.highlighted]="hoveredIndex === i"
               (mouseenter)="setHoveredIndex(i)"
               (mouseleave)="clearHoveredIndex()">
            <div class="subtitle-time">
              {{ subtitle.startTime }} ‚Üí {{ subtitle.endTime }}
            </div>
            <div class="subtitle-text">{{ subtitle.text }}</div>
          </div>
        </div>
      </div>

      <div *ngIf="translatedSrtContent" class="subtitle-column">
        <h4>Traduzido (PT-BR)</h4>
        <div class="subtitle-list"
             #translatedList
             (scroll)="onScroll($event, 'translated')">
          <div *ngFor="let subtitle of subtitles; let i = index" 
               class="subtitle-item"
               [class.highlighted]="hoveredIndex === i"
               (mouseenter)="setHoveredIndex(i)"
               (mouseleave)="clearHoveredIndex()">
            <div class="subtitle-time">
              {{ subtitle.startTime }} ‚Üí {{ subtitle.endTime }}
            </div>
            <div class="subtitle-text translated">
              {{ subtitle.translatedText || subtitle.text }}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
